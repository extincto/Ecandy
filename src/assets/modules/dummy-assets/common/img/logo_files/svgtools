window.getthumb=function(n,t,r,u,f){function nt(n){var e=['xmlns:ns1=""','xmlns:NS1=""','xmlns:NS2=""','xmlns:NS3=""','xmlns:ns2=""','xmlns:ns3=""','xmlns:inkscape=""','xmlns:sodipodi=""','xmlns:sketch=""'],o,t,r;for(i=0;i<e.length;i++)n.svg=n.svg.replace(new RegExp(e[i],"g"),"");o=$(n.svg);t=Snap(o[0]);n.gradient=new Gradient;n.gradient.decode(n.color);var s="path, polygon, rect, circle, ellipse, polyline",f={},h=t.selectAll(s)[0].attr();f.fill=n.gradient.getsvgcolor(t);for(r in h)h.hasOwnProperty(r)&&(r.match(/:/g)||[]).length>1&&(f[r]="");t.selectAll(s).attr(f);var l=c.g(),u={x:n.width/2*n.scale_x-n.width*n.flip_x*n.scale_x,y:n.height/2*n.scale_y-n.height*n.flip_y*n.scale_y},a=parseFloat(n.offset_x-u.x),v=parseFloat(n.offset_y-u.y),y=n.scale_x*(parseInt(n.flip_x)?-1:1),p=n.scale_y*(parseInt(n.flip_y)?-1:1),w=parseInt(calc.fixDegree(n.rotation));l.attr({transform:"translate("+a+","+v+") rotate("+w+","+u.x+","+u.y+") scale("+y+","+p+")"});l.append(t)}function tt(n,i,r){function rt(){var r,t,i;y.attr("width",o);y.attr("height",n.height);l||y.css("overflow","visible");f.enabled?(e.attr({dy:"",textpath:d,"text-anchor":"middle",x:"",y:""}),f.type!="up"&&(f.startheight?e.attr({dy:f.startheight*.6}):e.attr({dy:n.height*.6})),r=$(e.node).attr("fill"),$(e.node.childNodes[0]).attr({startOffset:"50%",fill:r})):l?nt.attr({transform:"matrix(1 0 0 1 0 "+n.height*.65+")"}):e.attr({dy:n.height*.65,x:n.width/2});t=f.enabled?{x:n.width/2*n.scale_x-n.width*n.flip_x*n.scale_x,y:n.height/2*n.scale_y-n.height*n.flip_y*n.scale_y}:{x:n.width/2*n.scale_x-n.width*n.flip_x*n.scale_x,y:n.height/2*n.scale_y-n.height*n.flip_y*n.scale_y};i=v?parseFloat(v-t.x):parseFloat(n.offset_x-t.x);var u=parseFloat(n.offset_y-t.y),s=n.scale_x*(parseInt(n.flip_x)?-1:1),h=n.scale_y*(parseInt(n.flip_y)?-1:1),c=parseInt(calc.fixDegree(n.rotation));k.attr({transform:"translate("+i+","+u+") rotate("+c+","+t.x+","+t.y+") scale("+s+","+h+")"});$(n).data("ready",!0)}function ut(n){var t=n.font.replace(/\s/g,"").toLowerCase();return n.bold&&n.italic?t+="-bold-italic":n.italic?t+="-italic":n.bold&&(t+="-bold"),t}var y=$("<svg width='90' height='90'><\/svg>"),s=Snap(y[0]),g,e,a,p,w,b,tt,it,v;n.gradient=new Gradient;n.gradient.decode(n.color);var k=c.g(),nt=s.g(),d=s.path();d.attr("fill","none");var u=JSON.parse(n.format),f=JSON.parse(n.curvedline),o=n.width;h.push(u.font);g=ut(u);i&&!f.enabled?(e=nt.path(),k.append(s),opentype.load("/clientfonts/"+g+".woff",function(t,i){if(t)console.log("Could not load font "+g+": "+t);else{var f=i.getPath(u.text,0,0,u.size);fontPath=f.toPathData();r?n.width=n.width-60:o=o+60;e.attr({d:fontPath,fill:n.gradient.getsvgcolor(s)});rt()}})):(k.append(s),e=s.text(),d.attr({d:"M"+f.left.x+","+f.left.y+" C"+f.anchorleft.x+","+f.anchorleft.y+" "+f.anchorright.x+","+f.anchorright.y+" "+f.right.x+","+f.right.y}),t&&t.trim()!=""&&t!="false"?(a="",u.text.trim().replaceAll("  "," ").replaceAll("  "," ").toLowerCase()=="company name"?a=t:(p=t.indexOf(" "),p>0?(w=t.substring(0,p),b=t.substring(p+1)):(w=t,b=""),a=u.text.trim().toLowerCase()=="company"?w:u.text.trim().toLowerCase()=="name"?b:u.text),e.node.textContent=a,tt=u.text.length,it=a.length,f.enabled||(o=o/tt*it,n.width!=o&&(u.alignment=="left"?v=n.offset_x-(n.width-o)*n.scale_x/2:u.alignment=="right"&&(v=n.offset_x+(n.width-o)*n.scale_x/2)))):e.node.textContent=u.text,e.attr({"font-size":u.size,"font-style":u.italic||u.font=="Molle"?"italic":"","font-weight":u.bold?"bold":"","font-family":u.font,textpath:undefined,fill:n.gradient.getsvgcolor(s,o,n.height),"text-anchor":"Middle"}),rt())}function b(){var u,t=-1,n=window.navigator.userAgent,i=n.indexOf("MSIE "),f=n.indexOf("Trident/"),r;return i>0?t=parseInt(n.substring(i+5,n.indexOf(".",i)),10):f>0&&(r=n.indexOf("rv:"),t=parseInt(n.substring(r+3,n.indexOf(".",r)),10)),t>-1?t:u}var l=!1,e,h,v,y,p;typeof u=="undefined"?u=!1:l=!0;typeof f=="undefined"&&(f=!1);var s=$("<svg class='thumb' width='"+n.width+"' height='"+n.height+"'><\/svg>"),o={svg:s},h=[],c=Snap(s[0]);if(c.attr({viewBox:"0,0,"+s.attr("width")+","+s.attr("height")}),n.background_color){var k=c.g(),d=k.rect(0,0,s.attr("width"),s.attr("height")),a=new Gradient;a.colorlist.push(new Color(n.background_color));a.colorlist.push(new Color(n.background_color));d.attr("fill",a.getsvgcolor(c))}if(e=[],n.shape_list&&n.shape_list.length>0&&$.each(n.shape_list,function(n,t){e[t.index]=[t,"shape"]}),n.text_list&&n.text_list.length>0&&$.each(n.text_list,function(n,t){e[t.index]=[t,"text"]}),e&&e.length>0&&$.each(e,function(n){e[n]&&(e[n][1]=="shape"?nt(e[n][0]):e[n][1]=="text"&&($(e[n][0]).data("ready",!1),tt(e[n][0],l,f)))}),n.text_list&&n.text_list.length>0&&h.length>0&&r&&(h=h.filter(function(n,t,i){return t==i.indexOf(n)}),v=[],$.each(h,function(n,t){$.each(r,function(n,i){t==i.name&&v.push(i.googleimportstring)})}),y=v.join("|"),p='<style type="text/css">@import url("https://fonts.googleapis.com/css?family='+y+'");<\/style>',o.svg.find("defs").first().append(p)),b()&&b()<=11||(o.svg.attr("xmlns","http://www.w3.org/2000/svg"),o.svg.attr("xmlns:inkscape","http://www.inkscape.org/namespaces/inkscape"),o.svg.attr("xmlns:sodipodi","http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"),o.svg.attr("xmlns:xlink","http://www.w3.org/1999/xlink"),o.svg.attr("xmlns:ns1","http://www.inkscape.org/namespaces/inkscape"),o.svg.attr("xmlns:sketch","http://www.bohemiancoding.com/sketch/ns")),o.svg.find("desc").remove(),u){function g(){var n=!0;for(i=1;i<e.length;i++)e[i][1]!="text"||$(e[i][0]).data("ready")||(n=!1);return n}function w(){g()?u(o.svg):setTimeout(w,500)}w()}else return o}