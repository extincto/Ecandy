Drawningboard=function(){var n=this;n.isSave=!1;n.model;n.dom;n.loading;n.position=[];n.workspace;n.selector;n.flowtab;n.informationtab;n.contexttab;n.toolbar;n.alignbar;n.helpbar;n.currentstate=-1;n.messagemenu;n.ownerid;n.ownerkey;n.ownerpassword;n.ownerloginkey;n.ownermode=!1;n.fullaccess=!1;n.rights=0;n.editiconid=undefined;n.background;n.width;n.height;n.cliplist=[];n.recentcolors=[];n.fontlist=[];n.clipid=0;n.groupid=0;n.freemailquantity=0;n.textmeasurer;n.isOpera=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0;n.isFirefox=typeof InstallTrigger!="undefined";n.isSafari=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0;n.isIOS=navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i);n.isChrome=!!window.chrome&&!n.isOpera;n.isIE=/*@cc_on!@*/!1||!!document.documentMode;n.isTouch=$.touchSupport();n.api=new Api;n.localStorageTest=function(){var n="test";try{return localStorage.setItem(n,n),localStorage.removeItem(n),!0}catch(t){return!1}};n.localStorageTest()===!0&&(n.ownerkey=window.localStorage.getItem("username"),n.ownercaptcha=window.localStorage.getItem("captcha"),n.ownerpassword=window.localStorage.getItem("password"));n.companyname=decodeURIComponent(getQueryVariable("companyname"));n.category=getQueryVariable("category");n.icon=getQueryVariable("logo");n.mode=getQueryVariable("mode");n.firstdisplay=!0;n.plan=undefined;typeof fbq!="undefined"&&fbq("track","open_editor",{logo_id:n.icon,owner_mode:n.mode});n.dominantcolor;n.showbackground=!1;n.fontsloaded=!1;n.start=function(){n.localStorageTest()===!0&&window.localStorage.clear();n.api.loadLanguage(function(){$("body").on("dragover",function(n){n.stopPropagation();n.preventDefault();n.originalEvent.dataTransfer.dropEffect="copy"});$("body").on("drop",function(n){n.stopPropagation();n.preventDefault()});n.dom=$("#workspace");n.loading=$(".master-loading");n.startloading();colpick(n);var t=$('<svg id="textmeasurer"><\/svg>');$("#drawningboard").append(t);n.textmeasurer=Snap(t[0]);n.width=n.dom.width();n.height=n.dom.height();n.predraw()})};n.loadfonts=function(t,r){if(typeof t!="undefined"&&t!=null&&t.length>0)for(i=0;i<t.length;i++)t[i].name=t[i].name.replace(/['"]+/g,"");$.ajax({type:"post",url:n.api.font+"list",data:JSON.stringify({fontlist:t}),contentType:"application/json; charset=utf-8",dataType:"json"}).done(function(i){var u,f,o,e;for(n.fontlist=i.obj,t||(n.fontsloaded=!0),u=[],$.each(n.fontlist,function(n,t){t.googleimportstring&&u.push(t.googleimportstring)}),f=[],o=10;u.length>0;)f.push(u.splice(0,o));for(e=0;e<f.length;e++)WebFont.load({google:{families:f[e]}});r&&r()})};n.predraw=function(){n.flowtab=new Flowtab(n);n.informationtab=new Informationtab(n);n.contexttab=new Contexttab(n);n.toolbar=new Toolbar(n);n.alignbar=new Alignbar(n);n.helpbar=new Helpbar(n);(n.isSafari||n.isTouch)&&n.fixSafari();n.isIOS&&$("html").addClass("ipad ios7");n.registerEvents();n.draw()};n.fixSafari=function(){$("body").height(window.innerHeight);$("#logomaker").height(window.innerHeight);$("#logobody").height(window.innerHeight);window.scrollTo(0,0)};n.draw=function(){n.workspace=Snap("#workspace");n.workspace.attr("text-rendering","geometricPrecision");n.dom.on("contextmenu",function(){return!1});n.showtooltips();n.background=new Background(n);n.position=$("#drawningboard").position();n.selector=new Selector(n);n.ownerkey&&n.ownerkey!="false"?n.startownermode():n.toolbar.drawinitialelements()};n.startownermode=function(){$.ajax({type:"post",url:n.api.owner+"login",data:JSON.stringify({key:n.ownerkey,password:n.ownerpassword}),contentType:"application/json; charset=utf-8",dataType:"json"}).done(function(t){if(t.obj)if(t.obj.logged==!0)n.ownermode=!0,n.fullaccess=t.obj.fullaccess==1,n.rights=t.obj.rights,n.ownerloginkey=t.obj.loginKey,n.ownerid=t.obj.id,n.toolbar.startownermode(),n.contexttab.startownermode(),n.loadfonts(undefined);else{var i=new Messagebox(n,"Invalid Owner Token!",null,"Ok",null,n.toolbar.drawinitialelements);i.show()}n.endloading()})};n.undraw=function(){n.workspace.clear();n.selector.finish();n.background.finish()};n.confirmmessage=function(){n.messagemenu&&n.messagemenu.confirm()};n.reset=function(){n.selector.unselect();n.selector.endexplodedmode();n.selector.closecontext();n.undraw();$.each(n.cliplist,function(n,t){t.finish()});n.currentstate=-1;n.cliplist.splice(0);n.editiconid=undefined;n.toolbar.setdominantcolor("rgba(255, 255, 255, 0)");n.firstdisplay=!0;n.draw();n.selector.changed=0;n.clipid=0;n.groupid=0;n.dom.hide();n.dom.slideUp("fast",function(){n.dom.slideDown("fast")})};n.select=function(t){n.selector.select(t)};n.formatsvg=function(n){n.find("img.svg").each(function(){var t=jQuery(this),i=t.attr("id"),r=t.attr("class"),u=t.attr("src");jQuery.get(u,function(u){var f=jQuery(u).find("svg");typeof i!="undefined"&&(f=f.attr("id",i));typeof r!="undefined"&&(f=f.attr("class",r+" replaced-svg"));f=f.removeAttr("xmlns:a");t.replaceWith(f);n.find("svg").show()},"xml")})};n.showtooltips=function(){/iPad/i.test(navigator.userAgent)||$(document).tooltip({show:{effect:"drop",direction:"up",duration:"fast"},position:{my:"left top+10",at:"left bottom"},close:function(n,t){t.tooltip.hide()}})};n.registerEvents=function(){$(window).on("resize",function(){n.width=n.dom.width();n.height=n.dom.height();n.selector.redrawbg()});$(window).on("orientationchange",function(){(n.isSafari||n.isTouch)&&(n.fixSafari(),n.isIOS&&$("html").addClass("ipad ios7"))});window.onbeforeunload=function(){if(!n.isSave)return"Are you sure you want to quit without saving ?"}};n.addrecentcolor=function(t){var i=!1;$.each(n.recentcolors,function(n,r){t.r==r.r&&t.g==r.g&&t.b==r.b&&t.a==r.a&&(i=!0)});i||(n.recentcolors.unshift(t),n.recentcolors.length==7&&n.recentcolors.pop())};n.startloading=function(){n.loading.fadeIn()};n.endloading=function(){n.loading.hide()}}